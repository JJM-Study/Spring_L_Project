<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.example.myproject.library.mapper.LibraryMapper">
    <select id="selectMyLibraryItems" resultType="org.example.myproject.library.dto.MyLibraryItemsDto">
<!--        select * from user_library-->
        select
            a.lyb_no,
            b.prod_no,
            b.prod_name,
            b.seller_id,
            c.domain_type,
            c.file_purpose,
            c.original_filename,
            c.file_id,
            c.file_status,
            a.reg_dt as lyb_reg_dt,
            d.image_url
        from user_library as a
        inner join product_master as b on a.prod_no = b.prod_no
        LEFT join product_image as d on d.prod_no = a.prod_no and d.is_main = 1
        LEFT join file_master as c on c.domain_id = a.prod_no
        and c.file_purpose = "RELEASE"
        and c.domain_type = "PRODUCT"
<!--        and file_status="ACTIVE";-->
        where a.user_id = #{userId}
    </select>

    <!-- 2025/11/18 추가 -->
    <insert id="insertLibraryItems">
        insert into
            user_library (
                prod_no, user_id
            )
        values
        <foreach item="prodNo" collection="prodNos" separator=",">
            (
            #{prodNo},
            #{userId}
            )
        </foreach>
    </insert>

</mapper>